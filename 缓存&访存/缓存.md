# 缓存

## 1.发射队列（Issue Queue）[Out of Order]

## 2.发射队列(Issue Queue) [in-order]

## 3.重排序(ROB)

## 4. 6种基本的缓存优化
```
存储器平均访问时间 = 命中时间 + 缺失率 * 缺失代价
```

**分为三类：**
* 降低缺失率
--- 较大的快、较大的缓存、较高的相联度
* 降低确实代价
--- 多级缓存，为读操作设定高于写操作的优先级
* 缩短缓存中的命中时间
--- 在索引缓存时避免地址变换

3C模型
* 强制缺失（Compulosry）
* 容量缺失 (Capacity)
* 冲突缺失 (Conflict)
* 一致性缺失 (Coherency)


### 1. 增大块大小降低缺失率

利用空间局部性，但较大的块会增加缺失代价

因为减少了缓存中的块数，而较大的块会增加冲突缺失

高延迟和高带宽采用大块---> 缓存在每次缺失时能获取的字节更多，而缺失代价增加的很少

### 2. 增大缓存以降低缺失率

增加缓存容量解决容量缺失率 --> 会延长命中时间，增加成本和功耗（主要用在片外）

### 3. 提高相联度降低缺失率

规律：

1.对于特定大小的缓存，从实际缺失率功效出发，八路组相联和全相联一样有效

2.规律 2 ：1 缓存经验规律，大小为 N 的直接映射缓存与大小为 N / 2 的俩路组相联缓存具有大体相同的缺失率

### 4.采用多级缓存降低缺失代价

* 加快缓存速度以与处理器速度相匹配
* 增大缓存避免加宽处理器与主存储器之间的鸿沟

L1 -> 匹配速度
L2 -> 增大缓存

```
存储器平均访问时间 = 命中时间L1 + 缺失率L1 * （命中时间L2 + 缺失率L2 * 缺失代价L2）
```

* 局部缺失率 --> 缓存中的缺失数除以对该缓存进行的存储器访问总数
* 全局缺失率 --> 缓存中的缺失数除以处理器产生的存储器访问总数


a.如果二级缓存远大于一级缓存，则全局缓存缺失率与二级缓存的单一缓存缺失率非常类似

b.局部缓存评价一级，全局缓存评价二级

多级包含： 方便检查一致性，但会使得各级缓存块大小保持一致

多级互斥： 提高L2的利用率

### 5.使读缺失的优先级高于写缺失，以降低缺失代价

a. 让缺失一直等待写缓冲区为空 

b. 发生读缺失时，检查写缓冲区内容，如果没有冲突而且存储器系统可用，则让读缺失继续

### 6.避免在索引缓存期间进行地址变换，以缩短命中时间
